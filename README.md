# Yume Waifus

Yume Waifus is an API-based web application built using **FastAPI** that allows users to generate waifu (anime-inspired character) images and interact with a playful, conversational AI chatbot. The primary purpose of the app is to provide users with both a fun visual experience and engaging chatbot responses.

## Key Features of Yume Waifus

### Waifu Image Generation:
- The app can generate waifu images based on different genres, allowing the user to select either safe-for-work (SFW) or not-safe-for-work (NSFW) content.
- The app uses an external API ([Waifu.pics](https://api.waifu.pics)) to fetch waifu images. Depending on the genre selected by the user, it makes a request to the corresponding API endpoint to retrieve an image.
- The images are saved locally with a timestamp in the "images" folder, and the app returns the image path (available for viewing through a local web server) as well as the image URL.
- Genres include SFW genres like waifu, neko, hug, kiss, smile, etc., and NSFW genres like trap, blowjob, etc.

### Chatbot Interaction:
- The app includes a conversational AI chatbot that responds based on the genre selected (either SFW or NSFW).
- The chatbot's tone and style are adjusted based on the `nsfw` parameter:
  - **SFW (Safe for Work)**: The chatbot maintains a friendly, playful, and positive tone, ensuring that all interactions are respectful and fun.
  - **NSFW (Not Safe for Work)**: The chatbot adopts a more flirty, cheeky, yet respectful tone, emphasizing lighthearted flirtation while maintaining respect and consensual boundaries.
- The app uses **Langchain** to manage conversation memory and create a dynamic and ongoing dialogue. It also interacts with **Groq**, an AI model (presumably Llama 3-8b), to generate conversational responses. The memory of past conversations is retained for up to 5 exchanges.

### Dynamic Prompt Creation:
- The chatbot’s behavior and responses are influenced by the `nsfw` parameter, creating different prompts based on whether the user is seeking SFW or NSFW content.
- The system message in the prompt helps guide the chatbot’s tone, either keeping it respectful and friendly for SFW or playful and flirtatious for NSFW, ensuring the interaction is always fun and consensual.

### File and Image Handling:
- The app checks if the "images" folder exists and creates it if it doesn’t, ensuring proper file management.
- Images fetched are stored locally in the "images" folder, and users can retrieve these images through the `/images/{image_name}` endpoint.
- The app returns the image path in the response, which is a URL pointing to the image location on the local server.

## Application Structure

### FastAPI Routes:
- `/generate`: The main endpoint for generating the waifu image and fetching the chatbot's response. It accepts the genre (e.g., "waifu", "neko") and nsfw (either "sfw" or "nsfw") as query parameters. The endpoint calls the `generate_waifu_image` function to get the image, saves it locally, and then invokes the chatbot functionality to return a response.
- `/images/{image_name}`: This endpoint serves the image generated by the `/generate` endpoint. It checks if the requested image exists in the "images" folder and returns the image using **FileResponse**. If the image is not found, it raises a 404 error.

## Technical Components:
- **FastAPI**: The backend framework is used for handling HTTP requests and serving images.
- **Requests**: This library is used to make HTTP requests to fetch images from the waifu API.
- **Langchain**: A framework used for managing language models and conversation memory. It integrates the chatbot functionality, which interacts with **Groq** to generate natural language responses based on the user's input.
- **Groq**: An AI model used to handle the language generation for the chatbot. It is initialized with the API key and model name ('llama3-8b-8192').
- **Datetime**: Used for timestamping the image files to avoid naming conflicts.
- **OS**: Helps in managing the creation and checking of directories, as well as handling file paths.

## Example Flow:
1. A user sends a GET request to `/generate` with parameters like `genre=waifu` and `nsfw=sfw`.
2. The server fetches the corresponding waifu image from the external API, saves it locally, and generates a playful chatbot response based on the SFW prompt.
3. The server returns the image URL and the chatbot response back to the user.

## Overall Project Purpose:
The **Yume Waifus** project is primarily aimed at providing an interactive, fun, and lighthearted experience through waifu images and AI chatbot interactions. It blends anime-inspired visuals with a customizable conversational AI, giving users the ability to enjoy both playful imagery and engaging chats with an AI that tailors its responses based on the context (SFW or NSFW).

